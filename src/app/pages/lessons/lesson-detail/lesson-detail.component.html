<app-navbar></app-navbar>

@if(lesson){
<section class="py-5" style="background-color: #f8f9fa;">
    <div class="container">

        <!-- Botón de volver -->
        <div class="mb-3">
            <button class="btn btn-outline-secondary d-flex align-items-center gap-2" (click)="goBack()">
                <i class="bi bi-arrow-left"></i>
                <span class="d-none d-sm-inline">Volver atrás</span>
            </button>
        </div>

        <!-- Cabecera -->
        <div class="mb-4">
            <h2 class="fw-bold mb-2">{{ lesson.title }}</h2>
            <p class="text-muted mb-1">
                Parte del curso:
                <a [routerLink]="['/courses', lesson.course.uuid]" class="text-decoration-none fw-semibold">
                    {{ lesson.course.title }}
                </a>
            </p>
            <div class="d-flex flex-wrap gap-2">
                <span class="badge bg-secondary">{{ lesson.durationMinutes }} min</span>
                <span class="badge" [ngClass]="lesson.freePreview ? 'bg-success' : 'bg-dark'">
                    {{ lesson.freePreview ? 'Vista previa' : 'Contenido premium' }}
                </span>
            </div>
        </div>

        <!-- Video -->
        <div class="mb-5">
            @if(lesson.video_url){
            <div class="ratio ratio-16x9 rounded-4 shadow-sm overflow-hidden">
                <iframe [src]="getSafeVideoUrl(lesson.video_url)" frameborder="0" allowfullscreen
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>
            </div>
            }
            @else {
            <div class="alert alert-warning">
                Esta lección no tiene un video disponible.
            </div>
            }
        </div>

        <!-- Descripción -->
        <div class="card border-0 shadow-sm rounded-4 p-4 bg-white">
            <h5 class="fw-bold mb-3">Descripción</h5>
            <p>{{ lesson.description }}</p>
        </div>

    </div>
</section>
}

<app-footer></app-footer>